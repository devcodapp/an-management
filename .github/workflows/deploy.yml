name: Deploy to VM

on:
  push:
    branches:
      - develop  # ajuste para a branch que deseja fazer o deploy

jobs:
  deploy:
    runs-on: ubuntu-latest  # ou outro sistema operacional suportado

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Install dependencies
      run: npm install  # ou yarn install, dependendo do gerenciador de pacotes

    - name: Build
      run: npm run build  # ajuste para o comando de build da sua aplicaçãodh

    - name: Deploy to VM
      run: |
        ssh codapp_dev@35.219.152.16 'cd /home/apps/back/an-management-dev && git pull && npm install && npm run build && pm2 restart your-app'
      env:
        SSH_PRIVATE_KEY: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC3wOBC9FaPQeU6sSr7j6aqOin+KidoFWAblF/xk7KjjL2PUo9Mbgr30KbKi8fD9sMRTmbPAUfiUtmEIK6/xzXXeSzX3K6YONDayJYI2uG7xy3/vVxFzLVutHuapP8SAZmRW41TUE78Im7sBbt0EY54h2Rj1sIOWV4Oc2kmOil2/xG/R1JKRVf8VTiJT+iT/C8gKnfb4Fq0odMoOghIlFMNJ1rsPjQHfsNqKpNaCo+iZfQo0DScDYHy0UGOgrHIgKsuCmO1QyYwOzBZAN9gkzccL6wGjWMj54X1TnJqdFFT0v9qjTDPmwR2tYRZrS+cConGm1ZvT3IrhiWLA51nG3V4pMsWgKRBx+jtWHa+d0bZyOq5LMpwT6gpqjddGiZTbea7WQyQOWBIcbmzo5hvJq9hfrPOQ43KJatq0NGL6fjk15XubEYpJYuQuOJOb1EGll/iMJaJYiSNJBAD2VDJP6qBY2XXVqj1+rBk3NY4Urehib8TSimvNQbh13u1aNBNtZ8= codapp_dev  # substitua pelo nome correto da variável secreta
